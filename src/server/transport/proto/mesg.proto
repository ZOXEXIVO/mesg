syntax = "proto3";

package grpc;

service MesgProtocol {
  rpc Push (PushRequest) returns (PushResponse) {}
  rpc Pull (PullRequest) returns (stream PullResponse) {}
  rpc Commit (CommitRequest) returns (CommitResponse) {}
  rpc Rollback (RollbackRequest) returns (RollbackResponse) {}
}

// Push
message PushRequest {
  string queue = 1;
  bytes data = 2;
  bool is_broadcast = 3;
}

message PushResponse {
  bool success = 1;
}

// Pull
message PullRequest {
  string queue = 1;
  string application = 2;
  int32 invisibility_timeout_ms = 3;
}

message PullResponse {
  string id = 1;
  bytes data = 2;
}

// Commit 

message CommitRequest {
  string id = 1;
  string queue = 2;
  string application = 3;
}

message CommitResponse {
  bool success = 1;
}

// Commit

message RollbackRequest {
  string id = 1;
  string queue = 2;
  string application = 3;
}

message RollbackResponse {
  bool success = 1;
}